---
title: "Revised Model Outputs for Subjunctive QP (3/2021)"
author: "Patrick Thane"
date: "3/16/2021"
output:
  html_document:
     toc: true
     toc_depth: 3
     toc_float: true
---

```{r, options-and-packages}
# Run packages
library(tidyverse)
library(effects)
library(ggeffects)
library(lme4)
library(lmerTest)
library(sjPlot)

options(scipen = 999)
```

```{r, load-data}
HS_EPT_Data = read_csv("../CSV Files/Heritage/Heritage EPT Subjunctive Data.csv")
HS_FCT_Data = read_csv("../CSV Files/Heritage/Heritage FCT Subjunctive Data.csv")
L2_EPT_Data = read_csv("../CSV Files/L2 Learners/L2 Learners EPT Subjunctive Data.csv")
L2_FCT_Data = read_csv("../CSV Files/L2 Learners/L2 Learners FCT Subjunctive Data.csv")
```

# Revised Research Questions

1. Does the token frequency of the matrix verb affect HS/L2 learners' use of the subjunctive in obligatory contexts?

2. Does the token frequency of the subordinate verb affect HS/L2 learners' use of the subjunctive in obligatory contexts?

3. Does frequency of use of Spanish affect HS' sensitivity to token frequency?

4. Does proficiency affect L2 learners' sensitivity to token frequency? 

5. Are there observable differences across tasks?


# Heritage Models
## Production
### Code
```{r, heritage-production-model}
Heritage_Mood_Production = glmer(
  ExpLI ~ Token_Lemma_Std + Token_Sub_Std + FofA_Std:Token_Lemma_Std + FofA_Std:Token_Sub_Std +
    (1 | Group_No) + (1 | Item),
  data = HS_EPT_Data, family = "binomial",
  control = glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun=3e5)))

summary(Heritage_Mood_Production)
```

### Output
```{r, print-heritage-production}
tab_model(Heritage_Mood_Production,
          pred.labels = c("Intercept", "Matrix verb frequency", "Subordinate verb frequency", "Frequency of use : matrix verb", "Frequency of use : subordinate verb"),
          dv.labels = c("Heritage Production"))
```

## Comprehension
### Code
```{r, heritage-comprehension-model}
Heritage_Mood_Comprehension = glmer(
  ExpLI ~ Token_Lemma_Std + Token_Sub_Std + FofA_Std:Token_Lemma_Std + FofA_Std:Token_Sub_Std +
    (1 | Group_No) + (1 | Item),
  data = HS_FCT_Data, family = "binomial",
  control = glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun=3e5)))

summary(Heritage_Mood_Comprehension)
```

### Output
```{r, print-heritage-comprehension}
tab_model(Heritage_Mood_Comprehension,
          pred.labels = c("Intercept", "Matrix verb frequency", "Subordinate verb frequency", "Frequency of use : matrix verb", "Frequency of use : subordinate verb"),
          dv.labels = c("Heritage Comprehension"))
```

# L2 Learner Models
## Production
### Code
```{r, L2-production-model}
L2_Mood_Production = glmer(
  ExpLI ~ Token_Lemma_Std + Token_Sub_Std + DELE_Std:Token_Lemma_Std + DELE_Std:Token_Sub_Std +
    (1 | Group_No) + (1 | Item),
  data = L2_EPT_Data, family = "binomial",
  control = glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun=3e5)))

summary(L2_Mood_Production)
```

### Output
```{r, print-L2-production}
tab_model(L2_Mood_Production,
          pred.labels = c("Intercept", "Matrix verb frequency", "Subordinate verb frequency", "Proficiency : matrix verb", "Proficiency : subordinate verb"),
          dv.labels = c("L2 Production"))
```

## Comprehension
```{r, L2-comprehension-model}
L2_Mood_Comprehension = glmer(
  ExpLI ~ Token_Lemma_Std + Token_Sub_Std + DELE_Std:Token_Lemma_Std + DELE_Std:Token_Sub_Std +
    (1 | Group_No) + (1 | Item),
  data = L2_FCT_Data, family = "binomial",
  control = glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun=3e5)))

summary(L2_Mood_Comprehension)
```

### Output
```{r, print-L2-comprehension}
tab_model(L2_Mood_Comprehension,
          pred.labels = c("Intercept", "Matrix verb frequency", "Subordinate verb frequency", "Proficiency : matrix verb", "Proficiency : subordinate verb"),
          dv.labels = c("L2 Comprehension"))
```
