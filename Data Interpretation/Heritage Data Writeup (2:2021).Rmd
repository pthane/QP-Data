---
title: "Heritage Data Writeup (2/2021)"
author: "Patrick Thane"
date: "2/12/2021"
output:
  html_document:
     toc: true
     toc_depth: 3
     toc_float: true
---

# Figure legend
## Tables
* **Table 1.** Results of output of GLMM for subjunctive mood production data for HS group.
* **Table 2.** Results of output of GLMM for subjunctive mood preference data for HS group.
* **Table 3.** Results of output of GLMM for preterit aspect production data for HS group.
* **Table 4.** Results of output of GLMM for preterit aspect preference data for HS group.


## Figures
* **Figure 1.** Average use of subjunctive morphology by group and task.
* **Figure 2.** Subjunctive use by proficiency level, production task.
* **Figure 3.** Subjunctive preference by proficiency level, FCT.
* **Figure 4.** Subjunctive use by self-reported quantity of use of Spanish, EPT.
* **Figure 5.** Subjunctive preference by self-reported quantity of use of Spanish, FCT.
* **Figure 6.** Subjunctive use by age of acquisition of English, EPT.
* **Figure 7.** Subjunctive preference by age of acquisition of English, FCT.
* **Figure 8.** Use of preterit with individual state verbs by group.
* **Table 9.** Preterit production by morphological regularity.
* **Figure 10.** Preterit production by proficiency level, EPT.
* **Figure 11.** Preterit preferences by proficiency level, FCT.
* **Figure 12.** Preterit preferences by self-reported frequency of use of Spanish, EPT.
* **Figure 13.** Preterit preferences by self-reported frequency of use of Spanish, EPT.

# Data loading and preparation
```{r setup, load-packages}
library(tidyverse)
library(dplyr)
library(lme4)
library(lmerTest)
library(emmeans)
library(sjPlot)
library(kableExtra)

options(scipen = 99)
```

```{R, load-files}
Heritage_Subjunctive_EPT = read_csv("../CSV Files/Heritage/EPT Subjunctive Standardized Heritage Data.csv")
Heritage_Preterit_EPT = read_csv("../CSV Files/Heritage/EPT Preterit Standardized Heritage Data.csv")
Heritage_Subjunctive_FCT = read_csv("../CSV Files/Heritage/FCT Subjunctive Standardized Heritage Data.csv")
Heritage_Preterit_FCT = read_csv("../CSV Files/Heritage/FCT Preterit Standardized Heritage Data.csv")
L2_Subjunctive_EPT = read_csv("../CSV Files/L2 Learners/EPT Subjunctive Standardized L2 Data.csv")
L2_Preterit_EPT = read_csv("../CSV Files/L2 Learners/EPT Preterit Standardized L2 Data.csv")
L2_Subjunctive_FCT = read_csv("../CSV Files/L2 Learners/FCT Subjunctive Standardized L2 Data.csv")
L2_Preterit_FCT = read_csv("../CSV Files/L2 Learners/FCT Preterit Standardized L2 Data.csv")
Comparison_Subjunctive_EPT = read.csv("../CSV Files/Comparison/EPT Subjunctive Standardized Comparison Data.csv")
Comparison_Preterit_EPT = read.csv("../CSV Files/Comparison/EPT Preterit Standardized Comparison Data.csv")
Comparison_Subjunctive_FCT = read.csv("../CSV Files/Comparison/FCT Subjunctive Standardized Comparison Data.csv")
Comparison_Preterit_FCT = read.csv("../CSV Files/Comparison/FCT Preterit Standardized Comparison Data.csv")
```

```{r, subjunctive-data-bind}
Subjunctive_EPT = rbind(L2_Subjunctive_EPT, Heritage_Subjunctive_EPT, Comparison_Subjunctive_EPT)
Subjunctive_FCT = rbind(L2_Subjunctive_FCT, Heritage_Subjunctive_FCT, Comparison_Subjunctive_FCT)
Subjunctive_Aggregate = rbind(Subjunctive_EPT, Subjunctive_FCT)

Heritage_EPT_Modified = aggregate(Heritage_Subjunctive_EPT$Average, list(Heritage_Subjunctive_EPT$Participant_ID), FUN = mean)
Heritage_EPT_Modified = Heritage_EPT_Modified %>% rename(Part_Avg = x)
Heritage_EPT_Modified = left_join(Heritage_Subjunctive_EPT, Heritage_EPT_Modified, by = c("Participant_ID" = "Group.1"))

Heritage_FCT_Modified = aggregate(Heritage_Subjunctive_FCT$Average, list(Heritage_Subjunctive_FCT$Participant_ID), FUN = mean)
Heritage_FCT_Modified = Heritage_FCT_Modified %>% rename(Part_Avg = x)
Heritage_FCT_Modified = left_join(Heritage_Subjunctive_FCT, Heritage_FCT_Modified, by = c("Participant_ID" = "Group.1"))

Subjunctive_EPT_Aggregate = aggregate(Subjunctive_EPT$Average, list(Subjunctive_EPT$Participant_ID), FUN = mean)
Subjunctive_EPT_Aggregate = Subjunctive_EPT_Aggregate %>% rename(Part_Avg = x)
Subjunctive_EPT_Aggregate = left_join(Subjunctive_EPT, Subjunctive_EPT_Aggregate, by = c("Participant_ID" = "Group.1"))

Subjunctive_FCT_Aggregate = aggregate(Subjunctive_FCT$Average, list(Subjunctive_FCT$Participant_ID), FUN = mean)
Subjunctive_FCT_Aggregate = Subjunctive_FCT_Aggregate %>% rename(Part_Avg = x)
Subjunctive_FCT_Aggregate = left_join(Subjunctive_FCT, Subjunctive_FCT_Aggregate, by = c("Participant_ID" = "Group.1"))
```

```{r, preterit-data-bind}
Preterit_EPT = rbind(L2_Preterit_EPT, Heritage_Preterit_EPT, Comparison_Preterit_EPT)
Preterit_FCT = rbind(L2_Preterit_FCT, Heritage_Preterit_FCT, Comparison_Preterit_FCT)
Preterit_Aggregate = rbind(Preterit_EPT, Preterit_FCT)

Heritage_EPT_Modified = aggregate(Heritage_Preterit_EPT$Average, list(Heritage_Preterit_EPT$Participant_ID), FUN = mean)
Heritage_EPT_Modified = Heritage_EPT_Modified %>% rename(Part_Avg = x)
Heritage_EPT_Modified = left_join(Heritage_Preterit_EPT, Heritage_EPT_Modified, by = c("Participant_ID" = "Group.1"))

Heritage_FCT_Modified = aggregate(Heritage_Preterit_FCT$Average, list(Heritage_Preterit_FCT$Participant_ID), FUN = mean)
Heritage_FCT_Modified = Heritage_FCT_Modified %>% rename(Part_Avg = x)
Heritage_FCT_Modified = left_join(Heritage_Preterit_FCT, Heritage_FCT_Modified, by = c("Participant_ID" = "Group.1"))

Preterit_EPT_Aggregate = aggregate(Preterit_EPT$Average, list(Preterit_EPT$Participant_ID), FUN = mean)
Preterit_EPT_Aggregate = Preterit_EPT_Aggregate %>% rename(Part_Avg = x)
Preterit_EPT_Aggregate = left_join(Preterit_EPT, Preterit_EPT_Aggregate, by = c("Participant_ID" = "Group.1"))

Preterit_FCT_Aggregate = aggregate(Preterit_FCT$Average, list(Preterit_FCT$Participant_ID), FUN = mean)
Preterit_FCT_Aggregate = Preterit_FCT_Aggregate %>% rename(Part_Avg = x)
Preterit_FCT_Aggregate = left_join(Preterit_FCT, Preterit_FCT_Aggregate, by = c("Participant_ID" = "Group.1"))
```

# Statistical models
## Mood models
### Subjunctive production in EPT
```{R, subjunctive-production-model}
Mood_Production = glmer(
  Average ~ AoA_ENG_Std + FofA_Std + DELE_Std + Token_Main_Lemma_Std + AoA_ENG_Std:FofA_Std + FofA_Std:Token_Main_Lemma_Std + AoA_ENG_Std:Token_Main_Lemma_Std +
    (1 | Group_No) + (1 | Item),
  data = Heritage_Subjunctive_EPT, family = "binomial",
  control = glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun=3e5)))

tab_model(Mood_Production)
```

#### **Table 1.** Results of output of GLMM for subjunctive mood production data for HS group.

### Subjunctive preferences in FCT
```{R, subjunctive-FCT-model}
Mood_Production = glmer(
  Average ~ AoA_ENG_Std + FofA_Std + DELE_Std + Token_Main_Lemma_Std + AoA_ENG_Std:FofA_Std + FofA_Std:Token_Main_Lemma_Std + AoA_ENG_Std:Token_Main_Lemma_Std +
    (1 | Group_No) + (1 | Item),
  data = Heritage_Subjunctive_FCT, family = "binomial",
  control = glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun=3e5)))

tab_model(Mood_Production)
```

#### **Table 2.** Results of output of GLMM for subjunctive mood preference data for HS group.

## Aspect models
### Preterit production in EPT
```{r, aspect-production-model}
Aspect_Production = glmer(
  Average ~ Token_Lemma_Std + FofA_Std + DELE_Std + Type_Main + FofA_Std:Token_Lemma_Std + FofA_Std:Type_Main + FofA_Std:Token_Lemma_Std:Type_Main +
    (1 | Group_No) + (1 | Item),
  data = Heritage_Preterit_EPT, family = "binomial",
  control = glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun=3e5)))

tab_model(Aspect_Production)
```
#### **Table 3.** Results of output of GLMM for preterit aspect production data for HS group.

### Preterit production in FCT
```{r, aspect-comprehension-model}
Aspect_Comprehension = glmer(
  Average ~ Token_Lemma_Std + FofA_Std + DELE_Std + Type_Main + FofA_Std:Token_Lemma_Std + FofA_Std:Type_Main + FofA_Std:Token_Lemma_Std:Type_Main +
    (1 | Group_No) + (1 | Item),
  data = Heritage_Preterit_FCT, family = "binomial",
  control = glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun=3e5)))

tab_model(Aspect_Comprehension)
```

#### **Table 4.** Results of output of GLMM for preterit aspect preference data for HS group.

# Subjunctive plots and summaries
**The following figures contain data from the L2 and comparison participants, in order to provide a point of comparison across groups.**

```{r, subjunctive-lexical-items}
Subjunctive_Aggregate %>%
  ggplot(aes(x = MainVerb, y = Average, color = ExpGroup, shape = Task)) + 
  geom_hline(yintercept = 0.5, color = 'white', size = 2) +
  stat_summary(fun = mean,
               geom = 'pointrange', size = 1, 
               position = position_dodge(width = 0.5)) + 
  scale_color_brewer(palette = "Set1", name = "") +
  ylim(c(0,1)) +
  labs(x = 'Matrix verb', y = 'Proportion of subjunctive responses', caption = '', 
       title = 'Average use of subjunctive by matrix item') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 1.** Average use of subjunctive morphology by group and task.

## By proficiency level
### Production
```{r, subjunctive-proficiency-EPT}
Subjunctive_EPT_Aggregate %>%
  ggplot(aes(x = DELE, y = Part_Avg, color = ExpGroup)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(25,50)) +
  ylim(c(0,1)) +
  labs(x = 'Correct responses on DELE proficiency measure', y = 'Proportion of subjunctive responses', caption = '', 
       title = 'Subjunctive by proficiency, EPT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 2.** Subjunctive use by proficiency level, production task.

### FCT
```{r, subjunctive-proficiency-FCT}
Subjunctive_FCT_Aggregate %>%
  ggplot(aes(x = DELE, y = Part_Avg, color = ExpGroup)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(25,50)) +
  ylim(c(0,1)) +
  labs(x = 'Correct responses on DELE proficiency measure', y = 'Proportion of subjunctive responses', caption = '', 
       title = 'Subjunctive by proficiency, FCT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 3.** Subjunctive preference by proficiency level, FCT.

## By frequency of use
### Production
```{r, subjunctive-use-production}
Subjunctive_EPT_Aggregate %>%
  ggplot(aes(x = FofA, y = Part_Avg, color = ExpGroup)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(5,50)) +
  ylim(c(0,1)) +
  labs(x = 'Self-reported frequency of use of Spanish', y = 'Proportion of subjunctive responses',
       title = 'Subjunctive by frequency of use, EPT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 4.** Subjunctive use by self-reported quantity of use of Spanish, EPT.

### FCT
```{r, subjunctive-use-FCT}
Subjunctive_FCT_Aggregate %>%
  ggplot(aes(x = FofA, y = Part_Avg, color = ExpGroup)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(5,50)) +
  ylim(c(0,1)) +
  labs(x = 'Self-reported frequency of use of Spanish', y = 'Proportion of subjunctive responses',
       title = 'Subjunctive by frequency of use, FCT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 5.** Subjunctive preference by self-reported quantity of use of Spanish, FCT.

## Age of acquisition
### Production
```{r, subjunctive-AoA-production}
## By age of acquisition
Heritage_EPT_Modified %>%
  ggplot(aes(x = AoA_ENG, y = Part_Avg)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(0,8)) +
  ylim(c(0,1)) +
  labs(x = 'Age of acquisition of English', y = 'Proportion of subjunctive responses', caption = '', 
       title = 'Subjunctive by age of acquisition, EPT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 6.** Subjunctive use by age of acquisition of English, EPT.

### FCT
```{r, subjunctive-AoA-FCT}
Heritage_FCT_Modified %>%
  ggplot(aes(x = AoA_ENG, y = Part_Avg)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(0,8)) +
  ylim(c(0,1)) +
  labs(x = 'Age of acquisition of English', y = 'Proportion of subjunctive responses', caption = '', 
       title = 'Subjunctive by age of acquisition, FCT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 7.** Subjunctive preference by age of acquisition of English, FCT.

# Preterit plots and summaries
**The following figures contain data from the L2 and comparison participants, in order to provide a point of comparison across groups.**

## By lexical item
```{r, preterit-lexical-items}
Preterit_Aggregate %>%
  ggplot(aes(x = MainVerb, y = Average, color = ExpGroup, shape = Task)) + 
  geom_hline(yintercept = 0.5, color = 'white', size = 2) +
  stat_summary(fun = mean,
               geom = 'pointrange', size = 1, 
               position = position_dodge(width = 0.5)) + 
  scale_color_brewer(palette = "Set1", name = "") +
  ylim(c(0,1)) +
  labs(x = 'State verb', y = 'Proportion of preterit responses', caption = '', 
       title = 'Average Use of Preterit by State Verb') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 8.** Use of preterit with individual state verbs by group.

## By morphological regularity
```{r, preterit-morph-regularity}
Preterit_Aggregate %>%
  ggplot(aes(x = Type_Main, y = Average, color = ExpGroup, shape = Task)) + 
  geom_hline(yintercept = 0.5, color = 'white', size = 2) + 
  stat_summary(fun = mean,
               geom = 'pointrange', size = 1, 
               position = position_dodge(width = 0.5)) + 
  scale_color_brewer(palette = "Set1", name = "") +
  ylim(c(0,1)) +
  labs(x = 'Log-transformed lemma frequency in Davies (2006)', y = 'Proportion of preterit responses', caption = '', 
       title = 'Morphological Regularity, Lexical Frequency, and Preterit Use') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Table 9.** Preterit production by morphological regularity.

## By proficiency
### Production
```{r, preterit-proficiency-production}
Preterit_EPT_Aggregate %>%
  ggplot(aes(x = DELE, y = Part_Avg, color = ExpGroup)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(25,50)) +
  ylim(c(0,1)) +
  labs(x = 'Correct responses on DELE proficiency measure', y = 'Proportion of preterit responses', caption = '', 
       title = 'Preterit by Proficiency, EAPT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 10.** Preterit production by proficiency level, EPT.

### FCT
```{r, preterit-proficiency-FCT}
Preterit_FCT_Aggregate %>%
  ggplot(aes(x = DELE, y = Part_Avg, color = ExpGroup)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(25,50)) +
  ylim(c(0,1)) +
  labs(x = 'Correct responses on DELE proficiency measure', y = 'Proportion of preterit responses', caption = '', 
       title = 'Preterit by Proficiency, APCT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 11.** Preterit preferences by proficiency level, FCT.

## By frequency of use
### Production
```{r, preterit-use-production}
Preterit_EPT_Aggregate %>%
  ggplot(aes(x = FofA, y = Part_Avg, color = ExpGroup)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(5,50)) +
  ylim(c(0,1)) +
  labs(x = 'Self-reported frequency of use of Spanish', y = 'Proportion of preterit responses',
       title = 'Preterit by Frequency of Use, EAPT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 12.** Preterit preferences by self-reported frequency of use of Spanish, EPT.

### FCT
```{r, preterit-use-FCT}
Preterit_FCT_Aggregate %>%
  ggplot(aes(x = FofA, y = Part_Avg, color = ExpGroup)) + 
  geom_point() +
  geom_smooth(method=lm) +
  xlim(c(5,50)) +
  ylim(c(0,1)) +
  labs(x = 'Self-reported frequency of use of Spanish', y = 'Proportion of preterit responses',
       title = 'Preterit by Frequency of Use, APCT') +
  theme(plot.title = element_text(hjust = 0.5))
```

#### **Figure 13.** Preterit preferences by self-reported frequency of use of Spanish, EPT.